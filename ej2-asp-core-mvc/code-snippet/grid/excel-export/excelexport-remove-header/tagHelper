<ejs-grid id='grid' dataSource="@ViewBag.dataSource" allowPaging='true' toolbar="@(new List<string>() { "ExcelExport" })" height='272px' allowExcelExport='true' toolbarClick='toolbarClick' excelQueryCellInfo="excelQueryCellInfo">
    <e-grid-columns>
        <e-grid-column field="Inventor" headerText="Inventor Name" width="180" textAlign="Right"></e-grid-column>
        <e-grid-column field="NumberofPatentFamilies" headerText="Number of Patent Families" width="180" textAlign="Right"></e-grid-column>
        <e-grid-column field="Country" headerText="Country" width="140" textAlign="Left"></e-grid-column>
        <e-grid-column field="Mainfieldsofinvention" headerText="Main fields of invention" width="200" textAlign="Left"></e-grid-column>
        <e-grid-column field="Number of INPADOC patents" headerText="Number of INPADOC patents" width="180" textAlign="Right"></e-grid-column>
        <e-grid-column field="TotalPatents" headerText="Total Patents" visible='false' valueAccessor="valueAccess" width="120"  textAlign="Right"></e-grid-column>
    </e-grid-columns>
</ejs-grid>
<script>
    function valueAccess(field, data) {
        var cell = inventoryData.indexOf(data) + 2;
        return '=D' + cell + '+' + 'B' + cell;
    }
    function excelQueryCellInfo(args) {
        if (args.column.field === 'TotalPatents') {
            args.value = valueAccess(args.column.field, args.data);
            args.cell.formula = args.value;
        }
    }   
    function toolbarClick(args) {
        var grid = document.getElementById("grid").ej2_instances[0];
        if (args.item.id === 'grid_excelexport') {
            var excelExportProperties = {
                includeHiddenColumn: true
            };
            grid.excelExport(excelExportProperties);
        }
    }
</script>