@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

<ejs-grid id="Grid" dataSource="@ViewBag.DataSource" allowPaging="true" allowPdfExport="true" toolbarClick="toolbarClick" pdfExportComplete="pdfExportComplete" height="272px" toolbar="@(new List<string>() {"PdfExport"})">
    <e-grid-columns>
        <e-grid-column field="OrderID" headerText="Order ID" isPrimaryKey="true" textAlign="Right" width="120"></e-grid-column>
        <e-grid-column field="CustomerID" headerText="Customer ID" width="150" visible="false"></e-grid-column>
        <e-grid-column headerText="Order Details" textAlign="Center" columns="@( new List<Syncfusion.EJ2.Grids.GridColumn>() {
                new Syncfusion.EJ2.Grids.GridColumn { Field = "OrderDate", Width = "130", HeaderText = "Order Date", Format="yMd", TextAlign= Syncfusion.EJ2.Grids.TextAlign.Right },
                new Syncfusion.EJ2.Grids.GridColumn { Field = "Freight", Width = "120", HeaderText = "Freight", Format="C2", TextAlign= Syncfusion.EJ2.Grids.TextAlign.Right }
                })">
        </e-grid-column>
        <e-grid-column headerText="Ship Details" textAlign="Center" columns="@( new List<Syncfusion.EJ2.Grids.GridColumn>() {
                new Syncfusion.EJ2.Grids.GridColumn { Field = "ShippedDate", Width = "120", HeaderText = "Shipped Date", TextAlign=Syncfusion.EJ2.Grids.TextAlign.Right, Format="yMd" },
                new Syncfusion.EJ2.Grids.GridColumn { Field = "ShipCountry", Width = "120", HeaderText = "Ship Country" },
                new Syncfusion.EJ2.Grids.GridColumn { Field = "ShipName", Width = "150", HeaderText = "Ship Name", Visible = false }
                })">
        </e-grid-column>
    </e-grid-columns>
</ejs-grid>

<script>
    function toolbarClick(args) {
        if (args.item.id === "Grid_pdfexport") {
            let grid = document.getElementById("Grid").ej2_instances[0];
            grid.getColumnByField("OrderDate").visible = false;
            grid.getColumnByField("ShippedDate").visible = true;
            grid.getColumnByField("ShipName").visible = true;
            grid.pdfExport();
        }
    }
    function pdfExportComplete() {
        let grid = document.getElementById("Grid").ej2_instances[0];
        grid.getColumnByField("OrderDate").visible = true;
        grid.getColumnByField("ShipName").visible = false;
    }
</script>