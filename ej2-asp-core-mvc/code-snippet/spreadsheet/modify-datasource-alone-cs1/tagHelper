@{
    var itemData = ViewBag.ItemData as List<Object>;
}

<div>
    <button id="changeDataBtn" class='e-btn'>Change Datasource</button>
</div>

<ejs-spreadsheet id="spreadsheet" created="created">
    <e-spreadsheet-sheets>
        <e-spreadsheet-sheet>
            <e-spreadsheet-ranges>
                <e-spreadsheet-range dataSource="ViewBag.DefaultData" showFieldAsHeader="true"></e-spreadsheet-range>
            </e-spreadsheet-ranges>
            <e-spreadsheet-columns>
                <e-spreadsheet-column width="120"></e-spreadsheet-column>
                <e-spreadsheet-column width="180"></e-spreadsheet-column>
                <e-spreadsheet-column width="100"></e-spreadsheet-column>
                <e-spreadsheet-column width="120"></e-spreadsheet-column>
                <e-spreadsheet-column width="120"></e-spreadsheet-column>
            </e-spreadsheet-columns>
        </e-spreadsheet-sheet>
    </e-spreadsheet-sheets>
</ejs-spreadsheet>

<script>

    var itemData = @Html.Raw(Json.Serialize(itemData));
    
    document.getElementById('changeDataBtn').addEventListener('click', () => {
        var spreadsheet = ej.base.getComponent(document.getElementById('spreadsheet'), 'spreadsheet');
          // You can also change the datasource of the range by changing dataSource property of the range by using below line of code.
        //To maintain the styles and format while changing the dataSource, you can utilize the below code.
        if (spreadsheet.sheets && spreadsheet.sheets[0].ranges) {
            spreadsheet.sheets[0].ranges[0].dataSource = [];
            spreadsheet.sheets[0].ranges[0] = { dataSource: itemData, startCell: 'A1', showFieldAsHeader: true };
            spreadsheet.dataBind();
            spreadsheet.refresh();
        }
    });

    function created() {
        var spreadsheet = ej.base.getComponent(document.getElementById('spreadsheet'), 'spreadsheet');
        spreadsheet.cellFormat(
            {
                fontFamily: 'Arial',
                fontWeight: 'bold',
                fontSize: '8pt',
            },
            'A1:N20'
        );
    }

</script>

<style>
    #changeDataBtn {
        margin-bottom: 10px;
    }

    hr {
        margin-top: 0;
        margin-bottom: 0;
    }
</style>
