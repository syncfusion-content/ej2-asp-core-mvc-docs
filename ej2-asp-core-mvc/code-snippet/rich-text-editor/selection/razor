@{
    var sliderValue = new int[] { 0, 50 };
}

<div class="sliderwrap">
    <label class="labeltext userselect">Range Slider</label>
    @Html.EJS().Slider("range").Value(sliderValue).Type(Syncfusion.EJ2.Inputs.SliderType.Range).Min(0).Max(400).Change("onChange").Render()
</div>

<div>
    @Html.EJS().RichTextEditor("editor").Height("400px").ContentTemplate(@<text><p>The Syncfusion Rich Text Editor, a WYSIWYG (what you see is what you get) editor, is a user interface that allows you to create, edit, and format rich text content. You can try out a demo of this editor here. Key features: Provides IFRAME and DIV modes. Bulleted and numbered lists. Handles images, hyperlinks, videos, hyperlinks, uploads, etc. Contains undo/redo manager.</p></text>).Render()
</div>

<script>
    var editorObj;
    var rangeObj;

    document.addEventListener('DOMContentLoaded', function () {
        editorObj = document.getElementById('editor').ej2_instances[0];
        rangeObj = document.getElementById('range').ej2_instances[0];

        editorObj.addEventListener('created', function () {
            const panel = editorObj.contentModule.getEditPanel();
            const realLength = panel.firstChild.firstChild.textContent.length;
            rangeObj.max = realLength;
            rangeObj.dataBind();
            // Focus the editor to activate selection
            panel.focus();

            // Apply initial selection
            onChange({ value: rangeObj.value });
        });
    });

    function onChange(args) {
        const [start, end] = args.value;
        const panel = editorObj.contentModule.getEditPanel();
        const maxLength = panel.textContent.length;

        // Ensure start and end are within valid bounds
        const safeStart = Math.min(start, maxLength);
        const safeEnd = Math.min(end, maxLength);

        // Find the text node and relative offset for both start and end
        const startInfo = getTextNodeAtOffset(panel, safeStart);
        const endInfo = getTextNodeAtOffset(panel, safeEnd);

        if (startInfo && endInfo) {
            const range = document.createRange();
            range.setStart(startInfo.node, startInfo.offset);
            range.setEnd(endInfo.node, endInfo.offset);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
        }
    }

    function getTextNodeAtOffset(root: Node, offset: number): { node: Text; offset: number } | null {
        let currentOffset = 0;
        const walker: TreeWalker = document.createTreeWalker(root, NodeFilter.SHOW_TEXT, null, false);
        while (walker.nextNode()) {
            const node = walker.currentNode as Text;
            const nodeLength = node.textContent.length;
            if (currentOffset + nodeLength >= offset) {
            return { node, offset: offset - currentOffset };
            }
            currentOffset += nodeLength;
        }
        return null;
    }

</script>